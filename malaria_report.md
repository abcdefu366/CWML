# üìò –ö—É—Ä—Å–æ–≤–æ–π –æ—Ç—á—ë—Ç
## –î–µ—Ç–µ–∫—Ü–∏—è –∑–∞—Ä–∞–∂—ë–Ω–Ω—ã—Ö –∫–ª–µ—Ç–æ–∫ –º–∞–ª—è—Ä–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Faster R-CNN

---

### 1. –í–≤–µ–¥–µ–Ω–∏–µ

–ó–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ –º–∞–ª—è—Ä–∏–µ–π –æ—Å—Ç–∞—ë—Ç—Å—è —Å–µ—Ä—å—ë–∑–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π –∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ —Ç—Ä–æ–ø–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö. –û–¥–Ω–∏–º –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö —ç—Ç–∞–ø–æ–≤ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —è–≤–ª—è–µ—Ç—Å—è –º–∏–∫—Ä–æ—Å–∫–æ–ø–∏—á–µ—Å–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –º–∞–∑–∫–æ–≤ –∫—Ä–æ–≤–∏. –í—Ä–∞—á-–ª–∞–±–æ—Ä–∞–Ω—Ç –≤—Ä—É—á–Ω—É—é –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤—ã—è–≤–ª—è—è –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É—è –ø–∞—Ä–∞–∑–∏—Ç–æ–≤ ‚Äî –ø—Ä–æ—Ü–µ—Å—Å —Ç—Ä—É–¥–æ—ë–º–∫–∏–π –∏ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–Ω—ã–π –æ—à–∏–±–∫–∞–º. –í –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ –±—ã–ª–∞ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–∞—á–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è.

---

### 2. –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏

–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî —Å–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, —Å–ø–æ—Å–æ–±–Ω—É—é:

- –û–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –∫–ª–µ—Ç–∫–∏ –∏ –ø–∞—Ä–∞–∑–∏—Ç–æ–≤ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö –º–∞–∑–∫–æ–≤ –∫—Ä–æ–≤–∏
- –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –ø–æ —Ç–∏–ø—É (—ç—Ä–∏—Ç—Ä–æ—Ü–∏—Ç—ã, —Ç—Ä–æ—Ñ–æ–∑–æ–∏—Ç—ã, —à–∏–∑–æ–Ω—Ç—ã, –≥–∞–º–µ—Ç–æ—Ü–∏—Ç—ã –∏ –¥—Ä.)

–í—ã—Ö–æ–¥ –º–æ–¥–µ–ª–∏ ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ–±—ä–µ–∫—Ç–æ–≤ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–º –∫–ª–∞—Å—Å—ã. –§–æ—Ä–º–∞–ª—å–Ω–æ ‚Äî –∑–∞–¥–∞—á–∞ **–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ (object detection)**.

---

### 3. –û–±–∑–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏

–ù–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—é –æ–±—ä–µ–∫—Ç–æ–≤ –≤–∫–ª—é—á–∞—é—Ç:

- –û–¥–Ω–æ—Å—Ç–∞–¥–∏–π–Ω—ã–µ –º–æ–¥–µ–ª–∏: YOLO, SSD
- –î–≤—É—Ö—Å—Ç–∞–¥–∏–π–Ω—ã–µ –º–æ–¥–µ–ª–∏: Faster R-CNN, Mask R-CNN

–í —Ä–∞–º–∫–∞—Ö –∫—É—Ä—Å–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ –¥–≤—É—Ö—Å—Ç–∞–¥–∏–π–Ω–∞—è –º–æ–¥–µ–ª—å **Faster R-CNN**, –∫–∞–∫ –æ–¥–Ω–∞ –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ —Ç–æ—á–Ω—ã—Ö –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –¥–ª—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ **Detectron2 (Facebook AI)**.

---

### 4. –í—ã–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö

–í –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –æ—Ç–∫—Ä—ã—Ç—ã–π –¥–∞—Ç–∞—Å–µ—Ç —Å Kaggle:  
üîó [Malaria Bounding Boxes (kmader)](https://www.kaggle.com/datasets/kmader/malaria-bounding-boxes)

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**

- 1 394 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- JSON-–∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏: bounding box + –∫–ª–∞—Å—Å
- 7 –∫–∞—Ç–µ–≥–æ—Ä–∏–π (red blood cell, trophozoite, ring, schizont, gametocyte, difficult, leukocyte)

–î–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞–Ω—ã –∏ —Å–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç **COCO**, —É–¥–æ–±–Ω—ã–π –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –≤ Detectron2.

---

### 5. –ú–µ—Ç–æ–¥–∏–∫–∞ –∏ –º–æ–¥–µ–ª—å

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- Backbone: ResNet-50 —Å FPN
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ: Region Proposal Network (RPN)
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è: ROI-Align + Fully Connected head

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—É—á–µ–Ω–∏—è:**
- –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –≤–µ—Å–∞ –Ω–∞ COCO
- Learning rate: 0.00025
- Batch size: 2
- –ò—Ç–µ—Ä–∞—Ü–∏–∏: 2500 –∏ 5000
- –ö–æ–ª-–≤–æ –∫–ª–∞—Å—Å–æ–≤: 7

---

### 6. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏ –æ–±—É—á–µ–Ω–∏–µ

–ú–æ–¥–µ–ª—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–∞ Python —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:
- PyTorch
- Detectron2
- Kaggle API
- OpenCV –∏ Matplotlib –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

–°–∫—Ä–∏–ø—Ç `train_model.py` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –°–∫–∞—á–∏–≤–∞–µ—Ç –∏ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –≤ COCO
- –û–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å Faster R-CNN
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–µ—Å–∞
- –í—ã–≤–æ–¥–∏—Ç –º–µ—Ç—Ä–∏–∫–∏
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

–¢–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–æ—É—Ç–±—É–∫ `–ú–ö–†–¢.ipynb` ‚Äî –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ Google Colab.

---

### 7. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∞–Ω–∞–ª–∏–∑

**–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä        | 2500 –∏—Ç–µ—Ä–∞—Ü–∏–π | 5000 –∏—Ç–µ—Ä–∞—Ü–∏–π |
|-----------------|----------------|----------------|
| mAP@[.5:.95]    | 19.3%          | 20.1%          |
| AP50            | 24.5%          | 25.4%          |
| Recall          | 23.3%          | 25.5%          |
| RBC             | 73.9%          | 75.1%          |
| Trophozoite     | 42.2%          | 45.3%          |
| –û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã | 0%            | 0%             |

**–í—ã–≤–æ–¥:** –º–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏, –Ω–æ –∏—Å–ø—ã—Ç—ã–≤–∞–µ—Ç —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏ —Å —Ä–µ–¥–∫–∏–º–∏ –∫–ª–∞—Å—Å–∞–º–∏ –∏–∑-–∑–∞ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞. –í–æ–∑–º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Focal Loss –∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏.

---

### 8. –í—ã–≤–æ–¥—ã –∏ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã

–ë—ã–ª–∞ —É—Å–ø–µ—à–Ω–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –æ–±—É—á–µ–Ω–∞ –º–æ–¥–µ–ª—å –¥–µ—Ç–µ–∫—Ü–∏–∏ –∫–ª–µ—Ç–æ–∫ –∏ –ø–∞—Ä–∞–∑–∏—Ç–æ–≤ –º–∞–ª—è—Ä–∏–∏. –ú–æ–¥–µ–ª—å —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–¥–∞—á–µ–π, —Ö–æ—Ç—è —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ–¥–∫–∏—Ö –∫–ª–∞—Å—Å–æ–≤.

**–í–æ–∑–º–æ–∂–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–ª—É—á—à–µ–Ω–∏–π:**
- –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤ / —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∫–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π
- Focal Loss –∏–ª–∏ Cascade R-CNN
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–ª–∏–Ω–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º–æ–π
